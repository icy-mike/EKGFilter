The following is a project I completed for my Medicine Clerkship essay at NYU School of Medicine in March 2017.

Engineering principles of electrocardiography

Michael Nguyen
Clerkship in Medicine

Ms. Z. is an 80-year-old female who presented to the emergency department complaining of shooting back and thigh pain for two weeks, admitted to the medicine service for an incidental finding of paroxysmal atrial fibrillation.

The electrocardiogram (EKG) is a voltmeter which measures cardiac biopotentials on the skin surface, which projects a function of voltage versus time, v(t).  This paper describes how the physiologic biopotential signal is electrically processed to display as the EKG printout.

The interface of the transduction of the electrical signal lies at the Ag/AgCl skin electrodes which transduce the ion current of the action potential to measurable electrical current, which is input into an electrical circuit to be amplified and filtered.  The electrical circuit configuration of the EKG can be simplified to a series of four series circuit elements, (1) signal input and differential amplifier with ground (conventionally the right leg), (2) low-pass filter, (3) high-pass filter, and (4) 60 Hz notch filter. The effect of the differential amplifier component of the EKG circuit can be described as  where G is the gain of the system and V2-V1 is the voltage difference between the two electrodes.   Differential amplifiers are chosen which have a very high common mode rejection ratio, which cancels out signal of similar phase and magnitude originating from the electrodes.  This is particularly important in EKG measurement because of the low absolute signal differences between electrodes superimposed on a noisy electrical environment1.  The chest leads (V1-V6) are unipolar, only incorporating the electrical activity passing one electrode, although noise can largely be filtered out using the right leg as the ground electrode to eliminate common signal.  The augmented leads can be calculated as , all relative to RL ground.  Although the main circuit component of the EKG is the signal input and amplification, the frequency filtering attenuates electrical and motion artifact, which can be present despite a high common mode rejection ratio.  Sources of low frequency artifact can include respiration and body movement, while high frequency artifact can be generated by muscle contraction2,3.  The 60 Hz notch filter is designed to attenuate ambient 60 Hz alternating current and the high and low-pass filters attenuate signals outside the desired measurement bandwidth of an EKG4.  Proper filtering to maximize the signal-to-noise ratio in EKG measurements is extremely important, as an EKG must reliably measure voltage magnitude changes on the order of sub-mV5.

Any periodic signal, such as an EKG, can be broken down into the sum of sine functions, , using a Fourier transformation, generating a function of frequency, V(), from the EKG signal, v(t). The Bode plot is a commonly used tool in engineering to represent the gain of an electrical system with respect its frequency and can attenuate or amplify characteristics of the voltage output, v(t), based on the characteristics of the frequency, V().  The Bode plot is constructed using transfer functions, H(s), which represent each frequency filter’s effect on amplifying and reducing gain.  In the simplified model of the EKG described in this paper, three transfer functions are used: the high-pass filter to attenuate low frequencies, the low-pass filter to attenuate high frequencies, and the notch filter at 60 Hz to attenuate ambient alternating current signal. Their formulae can be enumerated as:
In these formulae,  represents the cutoff frequency and s is the transfer function independent variable.  The cutoff frequencies for EKGs vary between manufacturers but generally are around 0.5 to 50 Hz6. Below are the individual low-pass, high-pass, and notch filters used to attenuate non-physiologic frequencies.  The axes below are shown on a log-log scale, with frequency in Hz on the x-axis and gain in decibels on the y-axis (decibel gain is a logarithmic unit).  The MATLAB source code to generate the following Bode plots is appended.


Figure 1. Individual Bode plots of filters.  Left: low pass filter, middle: high pass filter, right: notch filter.

Bode plots can be combined by the product of their respective transfer functions.  The resultant frequency response of the system is one with signal attenuation outside the bandwidth of 0.5 to 50 Hz, with strong attenuation at 60 Hz.  The aggregate filter is shown in the figure below and its equation can be described as:



Figure 2. Combined frequency response of the EKG signal processing system.

Once the EKG signal is filtered in the frequency domain with the transfer function, it can be converted back into a voltage versus time signal, vout(t), using an inverse Fourier transformation.  This signal is the one which appears on the EKG machine and printout.


Figure 3. Steps of processing EKG signal.

EKG signal processing is an intriguing and clinically relevant application of engineering in medicine.  In addition to simply displaying the signal, frequency analysis of EKGs is being studied and used for machine interpretation of EKGs, although current algorithms are frequently erroneous. Maximizing signal-to-noise ratio in the measurement, filtering, and display of EKG signals is important for diagnostic accuracy and provides physicians with a powerful and cheap modality to evaluate patients.  

Code appendix:
%Michael Nguyen, Clerkship in Medicine
options = bodeoptions('cstprefs');
options.PhaseVisible = 'off';
options.FreqUnits = 'Hz';
options.ylim = [-60,0];
lowpass = tf([50],[1 50])
highpass = tf([1 0],[1 0.5])
notch = tf([1 0 50*4000],[1 (50+4000) 50*4000])
filter = lowpass*highpass*notch
figure
bodeplot(filter,options)
 
figure
subplot(1,3,1)
bodeplot(lowpass,options)
subplot(1,3,2)
bodeplot(highpass,options)
subplot(1,3,3)
bodeplot(notch,options)

OUTPUT:
lowpass =
 
    50
  ------
  s + 50
 

highpass =
 
     s
  -------
  s + 0.5
 
notch =
 
      s^2 + 200000
  ---------------------
  s^2 + 4050 s + 200000
 

filter =
 
                 50 s^3 + 1e07 s
  ----------------------------------------------
  s^4 + 4100 s^3 + 404550 s^2 + 1.02e07 s + 5e06

Note: https://www.mathworks.com/help/control/ref/bodeplot.html describes the use of the MATLAB “bodeplot” function.

References:
1. 	Thakor NV, Webster JG. Ground-Free ECG Recording with Two Electrodes. IEEE Trans Biomed Eng. 1980;BME-27(12):699-704. doi:10.1109/TBME.1980.326595.
2. 	Tong DA, Bartels KA, Honeyager KS. Adaptive reduction of motion artifact in the electrocardiogram. In: Proceedings of the Second Joint 24th Annual Conference and the Annual Fall Meeting of the Biomedical Engineering Society] [Engineering in Medicine and Biology. Vol 2. ; 2002:1403-1404 vol.2. doi:10.1109/IEMBS.2002.1106451.
3. 	Srikureja W, Darbar D, Reeder GS. Tremor-Induced ECG Artifact Mimicking Ventricular Tachycardia. Circulation. 2000;102(11):1337-1338. doi:10.1161/01.CIR.102.11.1337.
4. 	Hamilton PS. A comparison of adaptive and nonadaptive filters for reduction of power line interference in the ECG. IEEE Trans Biomed Eng. 1996;43(1):105-109. doi:10.1109/10.477707.
5. 	Lee HO, Lee SJ, Jeong SH, et al. A Development and Clinical Evaluation of Automated Diagnostic Algorithm for Atrial Fibrillation using 12-lead EKG. In: World Congress on Medical Physics and Biomedical Engineering 2006. Springer, Berlin, Heidelberg; 2007:1195-1198. doi:10.1007/978-3-540-36841-0_288.
6. 	Lanata A, Guidi A, Baragli P, Valenza G, Scilingo EP. A Novel Algorithm for Movement Artifact Removal in ECG Signals Acquired from Wearable Systems Applied to Horses. PLOS ONE. 2015;10(10):e0140783. doi:10.1371/journal.pone.0140783. 

